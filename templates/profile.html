{% extends "base.html" %}

{% block title %}ä¸ªäººèµ„æ–™ - FitLife{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div class="dashboard-header mb-4">
            <h2 class="h3 text-center mb-0">
                <i class="fas fa-user-circle me-3 text-primary"></i>ğŸ‘¤ ä¸ªäººèµ„æ–™
            </h2>
        </div>
    </div>
</div>

<div class="row g-4">
    <!-- åŸºæœ¬ä¿¡æ¯å¡ç‰‡ -->
    <div class="col-lg-6">
        <div class="card h-100">
            <div class="card-header bg-gradient text-white" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                <h5 class="mb-0">
                    <i class="fas fa-id-card me-2"></i>åŸºæœ¬ä¿¡æ¯
                </h5>
            </div>
            <div class="card-body">
                {% if current_user.profile %}
                <div class="row g-3">
                    <div class="col-md-6">
                        <div class="stat-card">
                            <div class="stat-number">{{ current_user.profile.height or 'æœªè®¾ç½®' }}</div>
                            <small class="text-muted">èº«é«˜ (cm)</small>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="stat-card">
                            <div class="stat-number">{{ current_user.profile.weight or 'æœªè®¾ç½®' }}</div>
                            <small class="text-muted">ä½“é‡ (kg)</small>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="stat-card">
                            <div class="stat-number">{{ current_user.profile.age or 'æœªè®¾ç½®' }}</div>
                            <small class="text-muted">å¹´é¾„</small>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="stat-card">
                            <div class="stat-number">{{ current_user.profile.gender or 'æœªè®¾ç½®' }}</div>
                            <small class="text-muted">æ€§åˆ«</small>
                        </div>
                    </div>
                </div>

                <!-- BMIè®¡ç®— -->
                {% if current_user.profile.height and current_user.profile.weight %}
                <div class="mt-4">
                    <h6 class="mb-3">å¥åº·æŒ‡æ ‡</h6>
                    {% set bmi = (current_user.profile.weight / ((current_user.profile.height / 100) ** 2)) | round(1) %}
                    <div class="health-score-container text-center">
                        <div class="health-score-circle">
                            <div>
                                <div class="health-score-value">{{ bmi }}</div>
                                <div class="health-score-max">BMI</div>
                            </div>
                        </div>
                        <div class="health-score-label">
                            {% if bmi < 18.5 %}
                                åç˜¦
                            {% elif bmi < 24 %}
                                æ­£å¸¸
                            {% elif bmi < 28 %}
                                è¿‡é‡
                            {% else %}
                                è‚¥èƒ–
                            {% endif %}
                        </div>
                    </div>
                </div>
                {% endif %}
                {% else %}
                <div class="text-center py-4">
                    <i class="fas fa-user-plus fa-3x text-muted mb-3"></i>
                    <p class="text-muted">æ‚¨è¿˜æ²¡æœ‰å®Œå–„ä¸ªäººèµ„æ–™</p>
                </div>
                {% endif %}
            </div>
            <div class="card-footer">
                <a href="{{ url_for('profile_setup') }}" class="btn btn-gradient w-100">
                    <i class="fas fa-edit me-2"></i>ç¼–è¾‘èµ„æ–™
                </a>
            </div>
        </div>
    </div>

    <!-- è´¦æˆ·ä¿¡æ¯å¡ç‰‡ -->
    <div class="col-lg-6">
        <div class="card h-100">
            <div class="card-header bg-gradient text-white" style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);">
                <h5 class="mb-0">
                    <i class="fas fa-user-cog me-2"></i>è´¦æˆ·ä¿¡æ¯
                </h5>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <label class="form-label text-muted">ç”¨æˆ·å</label>
                    <div class="form-control-plaintext">{{ current_user.username }}</div>
                </div>
                <div class="mb-3">
                    <label class="form-label text-muted">é‚®ç®±</label>
                    <div class="form-control-plaintext">{{ current_user.email }}</div>
                </div>
                <div class="mb-3">
                    <label class="form-label text-muted">æ³¨å†Œæ—¶é—´</label>
                    <div class="form-control-plaintext">{{ current_user.created_at.strftime('%Y-%m-%d') }}</div>
                </div>
                
                <!-- ä½¿ç”¨ç»Ÿè®¡ -->
                <div class="mt-4">
                    <h6 class="mb-3">ä½¿ç”¨ç»Ÿè®¡</h6>
                    <div class="row g-2">
                        <div class="col-4">
                            <div class="stat-card">
                                <div class="stat-number text-muted">0</div>
                                <small class="text-muted">é¥®é£Ÿè®°å½•</small>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="stat-card">
                                <div class="stat-number text-success">{{ current_user.exercise_logs|length }}</div>
                                <small class="text-muted">è¿åŠ¨è®°å½•</small>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="stat-card">
                                <div class="stat-number text-warning">{{ current_user.goals|length }}</div>
                                <small class="text-muted">å¥èº«ç›®æ ‡</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- å¥èº«ç›®æ ‡éƒ¨åˆ† -->
<div class="row mt-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header bg-gradient text-white" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                <h5 class="mb-0">
                    <i class="fas fa-bullseye me-2"></i>å½“å‰å¥èº«ç›®æ ‡
                </h5>
            </div>
            <div class="card-body">
                {% if current_user.goals %}
                <div class="row g-3">
                    {% for goal in current_user.goals %}
                    <div class="col-md-4">
                        <div class="stat-card">
                            <h6 class="text-primary">{{ goal.goal_type_display }}</h6>
                            <div class="stat-number">{% if goal.target_weight %}{{ goal.target_weight }} kg{% else %}{{ goal.goal_type_display }}{% endif %}</div>
                            <small class="text-muted">ç›®æ ‡: {{ goal.target_date.strftime('%Y-%m-%d') if goal.target_date }}</small>
                            <div class="mt-2">
                                <div class="progress">
                                    {% set progress = ((goal.current_weight or 0) / goal.target_weight * 100) if goal.target_weight and goal.target_weight > 0 else 0 %}
                                    <div class="progress-bar" style="width: {{ progress|min(100) }}%"></div>
                                </div>
                                <small class="text-muted">å½“å‰: {{ goal.current_weight or 'æœªè®¾ç½®' }} kg</small>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <div class="text-center py-4">
                    <i class="fas fa-target fa-3x text-muted mb-3"></i>
                    <p class="text-muted">æ‚¨è¿˜æ²¡æœ‰è®¾ç½®å¥èº«ç›®æ ‡</p>
                </div>
                {% endif %}
            </div>
            <div class="card-footer">
                <a href="{{ url_for('goal_setup') }}" class="btn btn-gradient w-100">
                    <i class="fas fa-plus me-2"></i>è®¾ç½®ç›®æ ‡
                </a>
            </div>
        </div>
    </div>
</div>

<!-- å¿«æ·æ“ä½œ -->
<div class="row mt-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header bg-gradient text-white" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                <h5 class="mb-0">
                    <i class="fas fa-rocket me-2"></i>å¿«æ·æ“ä½œ
                </h5>
            </div>
            <div class="card-body">
                <div class="row g-3">
                    <div class="col-md-3">
                        <span class="btn btn-outline-secondary w-100 disabled">
                            <i class="fas fa-utensils d-block mb-2"></i>
                            é¥®é£Ÿæ‰“å¡
                        </span>
                    </div>
                    <div class="col-md-3">
                        <a href="{{ url_for('exercise_log') }}" class="btn btn-outline-success w-100">
                            <i class="fas fa-running d-block mb-2"></i>
                            è¿åŠ¨æ‰“å¡
                        </a>
                    </div>
                    <div class="col-md-3">
                        <a href="{{ url_for('progress') }}" class="btn btn-outline-info w-100">
                            <i class="fas fa-chart-line d-block mb-2"></i>
                            æŸ¥çœ‹è¿›åº¦
                        </a>
                    </div>
                    <div class="col-md-3">
                        <a href="{{ url_for('settings') }}" class="btn btn-outline-warning w-100">
                            <i class="fas fa-cog d-block mb-2"></i>
                            åº”ç”¨è®¾ç½®
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}